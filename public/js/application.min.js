var displayCSSChunk,displayOnlyDefined,getColorLuminance,hex,hexDigits,inlineToPanel,jsonToClass,jsonToPanel,makeActive,panelToJSON,rgb2hex,setDefaultStyle,styles,updateClasses;$(document).ready(function(){var e,s;return e=new Behave({textarea:document.getElementById("css-editor"),replaceTab:!0,softTabs:!0,tabSize:2,autoOpen:!0,overwrite:!0,autoStrip:!0,autoIndent:!0}),$(".input-color").minicolors({position:"bottom right"}),$(document).on("dblclick",".el",function(){return $(this).find(".el-content").attr("contentEditable",!0).focus(),console.log("hi")}),$(".css-includes").keyup(function(){return $(".el-active").attr("class","el el-box el-active defaultbox").addClass($(this).val())}),$(".css-editor").keyup(function(){return $("#userstyle").empty(),$("#userstyle").append($(this).val())}),$(".elidstyle").keyup(function(){return panelToJSON($(".el-active")),jsonToClass($(".el-active"))}),$(".elidstyle").change(function(){return panelToJSON($(".el-active")),jsonToClass($(".el-active"))}),$(".set-gradient").bind("keyup change",function(){var e,s,t;return t=$(".set-bk-color").val(),s=getColorLuminance(t,-$(this).val()),e="background-image: -o-linear-gradient(-90deg, "+t+" 0%, "+s+" 100%);\nbackground-image: -moz-linear-gradient(-90deg, "+t+" 0%, "+s+" 100%);\nbackground-image: -ms-linear-gradient(-90deg, "+t+" 0%, "+s+" 100%);\nbackground-image: linear-gradient(-180deg, "+t+" 0%, "+s+" 100%);",$(".set-gradient-code").val(e)}),$(".set-shadow").bind("keyup change",function(){var e,s,t,l,a,n,i,o;return i=$(".set-outershadow-x").val(),o=$(".set-outershadow-y").val(),e=$(".set-outershadow-b").val(),n=$(".set-outershadow-s").val(),s=$(".set-outershadow-c").val(),""!==$(".set-outershadow-c").val()&&(a=""+i+"px "+o+"px "+e+"px "+n+"px "+s),i=$(".set-innershadow-x").val(),o=$(".set-innershadow-y").val(),e=$(".set-innershadow-b").val(),n=$(".set-innershadow-s").val(),s=$(".set-innershadow-c").val(),""!==$(".set-innershadow-c").val()&&(l="inset "+i+"px "+o+"px "+e+"px "+n+"px "+s),t=void 0!==a&&void 0===l?"-moz-box-shadow: "+a+"; \nbox-shadow: "+a+";":void 0===a&&void 0!==l?"-moz-box-shadow: "+l+"; \nbox-shadow: "+l+";":void 0!==a&&void 0!==l?"-moz-box-shadow: "+a+", "+l+"; \nbox-shadow: "+a+", "+l+";":"",$(".set-shadow-code").val(t)}),$(".updatePageDim").click(function(){var e,s,t;return 0===$(".page").length?(s=$("<div class='page'></div>"),s.draggable({}),s.resizable()):s=$(".page"),t=$(".pageWidth").val(),e=$(".pageHeight").val(),$(".workspace").css("background","#FFFFFF").css("width",t+"px").css("height",e+"px")}),s=0,$(".addBox").click(function(){return setDefaultStyle(function(){var e;return e=$("<div class='el el-box' id='elid-"+s+"' data-elid='"+s+"'></div>"),e.append($("<div class='el-content'></div>")),e.addClass("defaultbox"),e.draggable({grid:[5,5],start:function(){return makeActive($(this)),updateClasses($(this))},stop:function(){return inlineToPanel(e)}}),e.resizable({grid:[5,5],stop:function(){return inlineToPanel(e),panelToJSON(e),jsonToClass(e)}}),makeActive(e),updateClasses(e),e.click(function(){return makeActive($(this)),updateClasses($(this))}),$(".workspace").append(e),s++})}),$(".createclass").click(function(){var e,s,t;return t=$(".el-active").data("elid"),e=$("#style-"+t).html(),e=e.replace("#elid-"+t,".newstyle"),s=$(".css-editor").val(),$(".css-editor").val(e+"\n"+s)}),$(".resetcss").click(function(){return setDefaultStyle(function(){return panelToJSON($(".el-active")),jsonToClass($(".el-active"))})})}),setDefaultStyle=function(e){return $(".elidstyle").val(""),$(".set-pos-top").val("20px"),$(".set-pos-left").val("20px"),$(".set-outershadow-x").val("1"),$(".set-outershadow-y").val("1"),$(".set-outershadow-b").val("3"),$(".set-outershadow-s").val("0"),$(".set-innershadow-x").val("0"),$(".set-innershadow-y").val("0"),$(".set-innershadow-b").val("3"),$(".set-innershadow-s").val("0"),e()},styles=[],panelToJSON=function(e){var s;return s=e.data("elid"),void 0===styles[s]&&(styles[s]={}),styles[s].width=$(".set-size-w").val(),styles[s].height=$(".set-size-h").val(),styles[s].textalign=$(".set-text-align").val(),styles[s].fontfamily=$(".set-font-family").val(),styles[s].fontweight=$(".set-font-weight").val(),styles[s].fontsize=$(".set-font-size").val(),styles[s].lineheight=$(".set-line-height").val(),styles[s].color=$(".set-color").val(),styles[s].borderradius=$(".set-border-radius").val(),styles[s].border=$(".set-border").val(),styles[s].bordercolor=$(".set-border-color").val(),styles[s].margin=$(".set-margin").val(),styles[s].padding=$(".set-padding").val(),styles[s].opacity=$(".set-opacity").val(),styles[s].backgroundcolor=$(".set-bk-color").val(),styles[s].gradientcode=$(".set-gradient-code").val(),styles[s].shadowcode=$(".set-shadow-code").val()},displayOnlyDefined=function(e){return void 0===e?"":e},jsonToPanel=function(e){var s;return s=e.data("elid"),$(".set-size-w").val(displayOnlyDefined(styles[s].width)),$(".set-size-h").val(displayOnlyDefined(styles[s].height)),$(".set-text-align").val(displayOnlyDefined(styles[s].textalign)),$(".set-font-family").val(displayOnlyDefined(styles[s].fontfamily)),$(".set-font-weight").val(displayOnlyDefined(styles[s].fontweight)),$(".set-font-size").val(displayOnlyDefined(styles[s].fontsize)),$(".set-line-height").val(displayOnlyDefined(styles[s].lineheight)),$(".set-color").val(displayOnlyDefined(styles[s].color)),$(".set-border-radius").val(displayOnlyDefined(styles[s].borderradius)),$(".set-border").val(displayOnlyDefined(styles[s].border)),$(".set-border-color").val(displayOnlyDefined(styles[s].bordercolor)),$(".set-margin").val(displayOnlyDefined(styles[s].margin)),$(".set-padding").val(displayOnlyDefined(styles[s].padding)),$(".set-opacity").val(displayOnlyDefined(styles[s].opacity)),$(".set-bk-color").val(displayOnlyDefined(styles[s].backgroundcolor)),$(".set-gradient-code").val(displayOnlyDefined(styles[s].gradientcode)),$(".set-shadow-code").val(displayOnlyDefined(styles[s].shadowcode))},displayCSSChunk=function(e,s){return void 0===s||""===s?"":void 0===e||""===e?s+"\n":"  "+e+": "+s+"; \n"},jsonToClass=function(e){var s,t,l;return t=e.data("elid"),0===$("#style-"+t).length&&(l=$("<style id='style-"+t+"'></style>"),$("head").append(l)),s="#elid-"+t+" {\n"+displayCSSChunk("width",styles[t].width)+displayCSSChunk("height",styles[t].height)+displayCSSChunk("top",styles[t].top)+displayCSSChunk("left",styles[t].left)+displayCSSChunk("font-family",styles[t].fontfamily)+displayCSSChunk("font-size",styles[t].fontsize)+displayCSSChunk("line-height","",styles[t].lineheight)+displayCSSChunk("font-weight",styles[t].fontweight)+displayCSSChunk("text-align",styles[t].textalign)+displayCSSChunk("color",styles[t].color)+displayCSSChunk("border-radius",styles[t].borderradius)+displayCSSChunk("border",styles[t].border)+displayCSSChunk("border-color",styles[t].bordercolor)+displayCSSChunk("margin",styles[t].margin)+displayCSSChunk("padding",styles[t].padding)+displayCSSChunk("opacity",styles[t].opacity)+displayCSSChunk("background-color",styles[t].backgroundcolor)+displayCSSChunk(!1,styles[t].gradientcode)+displayCSSChunk(!1,styles[t].shadowcode)+"}",$("#style-"+t).html(s)},inlineToPanel=function(e){var s,t,l,a;return a=e.css("width"),s=e.css("height"),l=e.css("top"),t=e.css("left"),$(".set-size-w").val(a),$(".set-size-h").val(s),$(".set-pos-top").val(l),$(".set-pos-left").val(t),e.attr("style","top: "+l+"; left: "+t)},makeActive=function(e){return $(".el-active").removeClass("el-active"),e.addClass("el-active"),void 0!==styles[e.data("elid")]?(jsonToPanel(e),jsonToClass(e)):(panelToJSON(e),jsonToClass(e))},updateClasses=function(e){var s,t,l,a,n,i;for(t=e.attr("class").split(" "),l="",a=["el","el-box","el-active","defaultbox","ui-draggable","ui-draggable-dragging","ui-resizable"],n=0,i=t.length;i>n;n++)s=t[n],a.indexOf(s)<=-1&&(l=s+" ");return $(".css-includes").val(l)},getColorLuminance=function(e,s){var t,l,a;for(e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),s=s||0,a="#",t=0,l=0;3>l;)t=parseInt(e.substr(2*l,2),16),t=Math.round(Math.min(Math.max(0,t+t*s),255)).toString(16),a+=("00"+t).substr(t.length),l++;return a},rgb2hex=function(e){return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+hex(e[1])+hex(e[2])+hex(e[3])},hex=function(e){return isNaN(e)?"00":hexDigits[(e-e%16)/16]+hexDigits[e%16]},hexDigits=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");