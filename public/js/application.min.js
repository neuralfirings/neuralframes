var displayCSSChunk,getColorLuminance,hex,hexDigits,makeActive,moveInlineStyle,rgb2hex,setDefaultStyle,updateClasses,updateStyle;$(document).ready(function(){var e,t;return e=new Behave({textarea:document.getElementById("css-editor"),replaceTab:!0,softTabs:!0,tabSize:2,autoOpen:!0,overwrite:!0,autoStrip:!0,autoIndent:!0}),$(".input-color").minicolors({position:"bottom right"}),$(document).on("dblclick",".el",function(){return $(this).find(".el-content").attr("contentEditable",!0).focus(),console.log("hi")}),$(".css-includes").keyup(function(){return $(".el-active").attr("class","el el-box el-active").addClass($(this).val())}),$(".css-editor").keyup(function(){return $("#userstyle").empty(),$("#userstyle").append($(this).val())}),$(".elidstyle").keyup(function(){return updateStyle($(".el-active"))}),$(".elidstyle").change(function(){return updateStyle($(".el-active"))}),$(".set-gradient").keyup(function(){var e,t,a;return a=$(".set-bk-color").val(),t=getColorLuminance(a,-$(this).val()),e="background-image: -o-linear-gradient(-90deg, "+a+" 0%, "+t+" 100%);\nbackground-image: -moz-linear-gradient(-90deg, "+a+" 0%, "+t+" 100%);\nbackground-image: -ms-linear-gradient(-90deg, "+a+" 0%, "+t+" 100%);\nbackground-image: linear-gradient(-180deg, "+a+" 0%, "+t+" 100%);",$(".set-gradient-code").html(e)}),$(".set-shadow").bind("keyup change",function(){var e,t,a,n,s,i,l,o;return l=$(".set-outershadow-x").val(),o=$(".set-outershadow-y").val(),e=$(".set-outershadow-b").val(),i=$(".set-outershadow-s").val(),t=$(".set-outershadow-c").val(),""!==$(".set-outershadow-c").val()&&(s=""+l+"px "+o+"px "+e+"px "+i+"px "+t),l=$(".set-innershadow-x").val(),o=$(".set-innershadow-y").val(),e=$(".set-innershadow-b").val(),i=$(".set-innershadow-s").val(),t=$(".set-innershadow-c").val(),""!==$(".set-innershadow-c").val()&&(n="inset "+l+"px "+o+"px "+e+"px "+i+"px "+t),a=void 0!==s&&void 0===n?"-moz-box-shadow: "+s+"; \nbox-shadow: "+s+";":void 0===s&&void 0!==n?"-moz-box-shadow: "+n+"; \nbox-shadow: "+n+";":void 0!==s&&void 0!==n?"-moz-box-shadow: "+s+", "+n+"; \nbox-shadow: "+s+", "+n+";":"",$(".set-shadow-code").html(a)}),$(".updatePageDim").click(function(){var e,t,a;return 0===$(".page").length?(t=$("<div class='page'></div>"),t.draggable({snap:!0}),t.resizable()):t=$(".page"),a=$(".pageWidth").val(),e=$(".pageHeight").val(),$(".workspace").css("background","#FFFFFF").css("width",a+"px").css("height",e+"px")}),t=0,$(".addBox").click(function(){var e;return setDefaultStyle(),e=$("<div class='el el-box' id='elid-"+t+"' data-elid='"+t+"'></div>"),e.append($("<div class='el-content'></div>")),e.addClass("defaultbox"),e.draggable({snap:!0,start:function(){return makeActive($(this)),updateClasses($(this))},stop:function(){return moveInlineStyle(e)}}),e.resizable({stop:function(){return moveInlineStyle(e)}}),makeActive(e),updateClasses(e),e.click(function(){return makeActive($(this)),updateClasses($(this))}),updateStyle(e),$(".workspace").append(e),t++}),$(".createclass").click(function(){var e,a;return t=$(".el-active").data("elid"),e=$("#style-"+t).html(),e=e.replace("#elid-"+t,".newstyle"),a=$(".css-editor").text(),$(".css-editor").text(e+"\n"+a)})}),setDefaultStyle=function(){return $(".set-pos-top").val("20px"),$(".set-pos-left").val("20px")},displayCSSChunk=function(e){return void 0===e?"":"  "+e},updateStyle=function(e){var t,a,n,s,i,l,o,r,d,c,u,h,p,g,v,y,f,S,b,C,k,m,x;return o={},x=$(".set-size-w").val(),""!==x&&(o.width="width: "+x+";\n"),p=$(".set-size-h").val(),""!==p&&(o.height="height: "+p+";\n"),m=$(".set-pos-top").val(),""!==m&&(o.top="top: "+m+";\n"),g=$(".set-pos-left").val(),""!==g&&(o.left="left: "+g+";\n"),k=$(".set-text-align").val(),""!==k&&(o.textalign="text-align: "+k+";\n"),d=$(".set-font-family").val(),""!==d&&(o.fontfamily="font-family: "+d+";\n"),u=$(".set-font-weight").val(),""!==u&&(o.fontweight="font-weight: "+u+";\n"),c=$(".set-font-size").val(),""!==c&&(o.fontsize="font-size: "+c+";\n"),v=$(".set-line-height").val(),""!==v&&(o.lineheight="line-height: "+v+";\n"),l=$(".set-color").val(),""!==l&&(o.color="color: "+l+";\n"),s=$(".set-border-radius").val(),""!==s&&(o.borderradius="border-radius: "+s+";\n"),a=$(".set-border").val(),""!==a&&(o.border="border: "+a+";\n"),n=$(".set-border-color").val(),""!==n&&(o.bordercolor="border-color: "+n+";\n"),y=$(".set-margin").val(),""!==y&&(o.margin="margin: "+y+";\n"),S=$(".set-padding").val(),""!==S&&(o.padding="padding: "+S+";\n"),f=$(".set-opacity").val(),""!==f&&(o.opacity="opacity: "+f+";\n"),t=$(".set-bk-color").val(),""!==t&&(o.backgroundcolor="background-color: "+t+";\n"),h=$(".set-gradient-code").html(),""!==h&&(o.gradientcode=""+h+";\n"),b=$(".set-shadow-code").html(),""!==b&&(o.shadowcode=""+b+";\n"),r=e.data("elid"),0===$("#style-"+r).length&&(C=$("<style id='style-"+r+"'></style>"),$("head").append(C)),i="#elid-"+r+" {\n"+displayCSSChunk(o.width)+displayCSSChunk(o.height)+displayCSSChunk(o.top)+displayCSSChunk(o.left)+displayCSSChunk(o.fontfamily)+displayCSSChunk(o.fontsize)+displayCSSChunk(o.lineheight)+displayCSSChunk(o.fontweight)+displayCSSChunk(o.textalign)+displayCSSChunk(o.color)+displayCSSChunk(o.borderradius)+displayCSSChunk(o.border)+displayCSSChunk(o.bordercolor)+displayCSSChunk(o.margin)+displayCSSChunk(o.padding)+displayCSSChunk(o.opacity)+displayCSSChunk(o.backgroundcolor)+displayCSSChunk(o.gradientcode)+displayCSSChunk(o.shadowcode)+"}",$("#style-"+r).html(i)},moveInlineStyle=function(e){var t,a,n,s,i;return i=e.css("width"),a=e.css("height"),s=e.css("top"),n=e.css("left"),t=rgb2hex(e.css("background-color")),$(".set-size-w").val(i),$(".set-size-h").val(a),$(".set-pos-top").val(s),$(".set-pos-left").val(n),$(".set-bk-color").val(t),e.attr("style",""),updateStyle(e)},makeActive=function(e){return $(".el-active").removeClass("el-active"),e.addClass("el-active")},updateClasses=function(e){var t,a,n,s,i,l;for(a=e.attr("class").split(" "),n="",s=["el","el-box","el-active","defaultbox","ui-draggable","ui-draggable-dragging","ui-resizable"],i=0,l=a.length;l>i;i++)t=a[i],s.indexOf(t)<=-1&&(n=t+" ");return $(".css-includes").val(n)},getColorLuminance=function(e,t){var a,n,s;for(e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0,s="#",a=0,n=0;3>n;)a=parseInt(e.substr(2*n,2),16),a=Math.round(Math.min(Math.max(0,a+a*t),255)).toString(16),s+=("00"+a).substr(a.length),n++;return s},rgb2hex=function(e){return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+hex(e[1])+hex(e[2])+hex(e[3])},hex=function(e){return isNaN(e)?"00":hexDigits[(e-e%16)/16]+hexDigits[e%16]},hexDigits=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");